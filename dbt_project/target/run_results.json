{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2026-01-10T00:09:57.566589Z", "invocation_id": "6932a54b-d083-45bc-bca6-ee63aa3a8c89", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.507747Z", "completed_at": "2026-01-10T00:09:55.563486Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.565759Z", "completed_at": "2026-01-10T00:09:55.725593Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.23110723495483398, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.stg_quality", "compiled": true, "compiled_code": "-- models/staging/stg_quality.sql\n-- Quality sensor measurements\n\nwith source as (\n    select * from \"stellantis_manufacturing\".\"staging\".\"stg_quality\"\n),\n\nrenamed as (\n    select\n        -- identifiers\n        row_id,\n        \n        -- quality result\n        pass_fail,\n        case \n            when pass_fail = 1 then 'PASS'\n            when pass_fail = -1 then 'FAIL'\n            else 'UNKNOWN'\n        end as quality_status,\n        \n        -- sensor readings\n        sensor_1,\n        sensor_2,\n        sensor_3,\n        \n        -- calculated\n        (sensor_1 + sensor_2 + sensor_3) / 3.0 as avg_sensor_reading,\n        \n        -- metadata\n        loaded_at as source_loaded_at,\n        current_timestamp as dbt_loaded_at\n    \n    from source\n)\n\nselect * from renamed", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_quality\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.503813Z", "completed_at": "2026-01-10T00:09:55.515701Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.553236Z", "completed_at": "2026-01-10T00:09:55.728720Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2371997833251953, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.stg_production", "compiled": true, "compiled_code": "-- models/staging/stg_production.sql\n-- Clean and standardize production data\n\nwith source as (\n    select * from \"stellantis_manufacturing\".\"staging\".\"stg_production_metrics\"\n),\n\nrenamed as (\n    select\n        -- identifiers\n        line_name as production_line,\n        production_date as date,\n        shift_name as shift,\n        vehicle_make,\n        vehicle_model,\n        vehicle_year,\n        \n        -- metrics\n        units_produced,\n        units_target,\n        defects,\n        downtime_minutes,\n        cycle_time_seconds,\n        oee_percent,\n        \n        -- calculated\n        units_produced * 150 as estimated_revenue,\n        downtime_minutes / 60.0 as downtime_hours,\n        case \n            when units_produced > 0 \n            then (defects::float / units_produced * 100)\n            else 0 \n        end as defect_rate_percent,\n        \n        -- metadata\n        loaded_at as source_loaded_at,\n        current_timestamp as dbt_loaded_at\n    \n    from source\n)\n\nselect * from renamed", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_production\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.499378Z", "completed_at": "2026-01-10T00:09:55.514937Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.516347Z", "completed_at": "2026-01-10T00:09:55.732274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2406167984008789, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.stg_maintenance", "compiled": true, "compiled_code": "-- models/staging/stg_maintenance.sql\n-- Predictive maintenance sensor data\n\nwith source as (\n    select * from \"stellantis_manufacturing\".\"staging\".\"stg_maintenance\"\n),\n\nrenamed as (\n    select\n        -- identifiers\n        udi as unit_device_id,\n        product_id,\n        type as product_type,\n        \n        -- sensor readings\n        air_temperature_k,\n        process_temperature_k,\n        rotational_speed_rpm,\n        torque_nm,\n        tool_wear_min,\n        \n        -- failure indicators\n        machine_failure,\n        twf as tool_wear_failure,\n        hdf as heat_dissipation_failure,\n        pwf as power_failure,\n        osf as overstrain_failure,\n        rnf as random_failure,\n        \n        -- calculated\n        air_temperature_k - 273.15 as air_temperature_c,\n        process_temperature_k - 273.15 as process_temperature_c,\n        \n        -- metadata\n        loaded_at as source_loaded_at,\n        current_timestamp as dbt_loaded_at\n    \n    from source\n)\n\nselect * from renamed", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_maintenance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.748847Z", "completed_at": "2026-01-10T00:09:55.757037Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.780033Z", "completed_at": "2026-01-10T00:09:55.903460Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.17041635513305664, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.int_quality_aggregated", "compiled": true, "compiled_code": "-- models/intermediate/int_quality_aggregated.sql\n-- Quality metrics aggregated for analysis\n\nwith quality as (\n    select * from \"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_quality\"\n),\n\naggregated as (\n    select\n        row_id,\n        pass_fail,\n        quality_status,\n        sensor_1,\n        sensor_2,\n        sensor_3,\n        avg_sensor_reading,\n        \n        -- sensor variance analysis\n        greatest(sensor_1, sensor_2, sensor_3) - \n        least(sensor_1, sensor_2, sensor_3) as sensor_range,\n        \n        -- individual sensor deviation from average\n        abs(sensor_1 - avg_sensor_reading) as sensor_1_deviation,\n        abs(sensor_2 - avg_sensor_reading) as sensor_2_deviation,\n        abs(sensor_3 - avg_sensor_reading) as sensor_3_deviation,\n        \n        -- quality confidence\n        case \n            when (greatest(sensor_1, sensor_2, sensor_3) - \n                  least(sensor_1, sensor_2, sensor_3)) < 100 \n            then 'HIGH_CONFIDENCE'\n            when (greatest(sensor_1, sensor_2, sensor_3) - \n                  least(sensor_1, sensor_2, sensor_3)) < 200 \n            then 'MEDIUM_CONFIDENCE'\n            else 'LOW_CONFIDENCE'\n        end as measurement_confidence,\n        \n        -- anomaly detection (simple threshold-based)\n        case \n            when avg_sensor_reading > 3500 or avg_sensor_reading < 2000 \n            then true \n            else false \n        end as is_anomaly,\n        \n        dbt_loaded_at\n        \n    from quality\n)\n\nselect * from aggregated", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_quality_aggregated\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.763073Z", "completed_at": "2026-01-10T00:09:55.788716Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.790272Z", "completed_at": "2026-01-10T00:09:55.913037Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1639566421508789, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.int_production_enriched", "compiled": true, "compiled_code": "-- models/intermediate/int_production_enriched.sql\n-- Production data enriched with business logic and classifications\n\nwith production as (\n    select * from \"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_production\"\n),\n\nenriched as (\n    select\n        -- original fields\n        production_line,\n        date,\n        shift,\n        vehicle_make,\n        vehicle_model,\n        vehicle_year,\n        units_produced,\n        units_target,\n        defects,\n        downtime_hours,\n        cycle_time_seconds,\n        oee_percent,\n        defect_rate_percent,\n        estimated_revenue,\n        \n        -- performance classification\n        case \n            when oee_percent >= 85 then 'EXCELLENT'\n            when oee_percent >= 70 then 'GOOD'\n            when oee_percent >= 60 then 'ACCEPTABLE'\n            else 'NEEDS_ATTENTION'\n        end as oee_category,\n        \n        -- production efficiency\n        case \n            when units_produced >= units_target then 'MET_TARGET'\n            when units_produced >= units_target * 0.9 then 'NEAR_TARGET'\n            else 'BELOW_TARGET'\n        end as target_achievement,\n        \n        -- quality classification\n        case \n            when defect_rate_percent <= 1.0 then 'EXCELLENT'\n            when defect_rate_percent <= 3.0 then 'GOOD'\n            when defect_rate_percent <= 5.0 then 'ACCEPTABLE'\n            else 'POOR'\n        end as quality_category,\n        \n        -- shift productivity score (weighted)\n        (oee_percent * 0.5) + \n        ((units_produced::float / units_target * 100) * 0.3) +\n        ((100 - defect_rate_percent) * 0.2) as productivity_score,\n        \n        -- downtime impact\n        case \n            when downtime_hours <= 0.5 then 'LOW'\n            when downtime_hours <= 1.0 then 'MEDIUM'\n            else 'HIGH'\n        end as downtime_impact,\n        \n        -- cost calculations\n        defects * 50 as defect_cost,\n        downtime_hours * 5000 as downtime_cost,\n        (defects * 50) + (downtime_hours * 5000) as total_loss,\n        \n        -- metadata\n        dbt_loaded_at\n        \n    from production\n)\n\nselect * from enriched", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.784123Z", "completed_at": "2026-01-10T00:09:55.797005Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.824024Z", "completed_at": "2026-01-10T00:09:55.934542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.18167757987976074, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.int_maintenance_features", "compiled": true, "compiled_code": "-- models/intermediate/int_maintenance_features.sql\n-- Machine health indicators and failure risk assessment\n\nwith maintenance as (\n    select * from \"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_maintenance\"\n),\n\nfeatures as (\n    select\n        unit_device_id,\n        product_id,\n        product_type,\n        \n        -- sensor readings\n        air_temperature_c,\n        process_temperature_c,\n        rotational_speed_rpm,\n        torque_nm,\n        tool_wear_min,\n        \n        -- failure flags\n        machine_failure,\n        tool_wear_failure,\n        heat_dissipation_failure,\n        power_failure,\n        overstrain_failure,\n        random_failure,\n        \n        -- calculated features\n        process_temperature_c - air_temperature_c as temp_differential,\n        \n        -- operating conditions\n        case \n            when air_temperature_c > 30 then 'HIGH_TEMP'\n            when air_temperature_c < 15 then 'LOW_TEMP'\n            else 'NORMAL_TEMP'\n        end as ambient_condition,\n        \n        -- speed classification\n        case \n            when rotational_speed_rpm > 2000 then 'HIGH_SPEED'\n            when rotational_speed_rpm > 1500 then 'MEDIUM_SPEED'\n            else 'LOW_SPEED'\n        end as speed_category,\n        \n        -- wear assessment\n        case \n            when tool_wear_min > 200 then 'CRITICAL'\n            when tool_wear_min > 150 then 'HIGH'\n            when tool_wear_min > 100 then 'MODERATE'\n            else 'LOW'\n        end as wear_status,\n        \n        -- power metric (torque \u00d7 speed)\n        torque_nm * rotational_speed_rpm / 9550.0 as power_kw,\n        \n        -- risk score (weighted sum of conditions)\n        (\n            case when tool_wear_min > 200 then 40 else tool_wear_min / 5.0 end +\n            case when process_temperature_c > 40 then 30 else 0 end +\n            case when rotational_speed_rpm > 2000 then 20 else 0 end +\n            case when torque_nm > 60 then 10 else 0 end\n        ) as failure_risk_score,\n        \n        -- failure type indicator\n        case \n            when tool_wear_failure = 1 then 'TOOL_WEAR'\n            when heat_dissipation_failure = 1 then 'HEAT'\n            when power_failure = 1 then 'POWER'\n            when overstrain_failure = 1 then 'OVERSTRAIN'\n            when random_failure = 1 then 'RANDOM'\n            when machine_failure = 1 then 'GENERAL'\n            else 'NO_FAILURE'\n        end as failure_type,\n        \n        dbt_loaded_at\n        \n    from maintenance\n)\n\nselect * from features", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_maintenance_features\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.757633Z", "completed_at": "2026-01-10T00:09:55.789325Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.797582Z", "completed_at": "2026-01-10T00:09:56.017540Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2690908908843994, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.stellantis_dbt.dim_vehicle_scd", "compiled": true, "compiled_code": "-- models/dimensions/dim_vehicle_scd.sql\n-- Vehicle dimension with SCD Type 2 structure\n\n\n\nwith source_data as (\n    select distinct\n        vehicle_make as make,\n        vehicle_model as model,\n        vehicle_year as year,\n        min(date) as first_seen_date,\n        max(date) as last_seen_date,\n        case \n            when vehicle_make like '%Peugeot%' then 28000\n            when vehicle_make like '%Jeep%' then 35000\n            else 30000\n        end as msrp\n    from \"stellantis_manufacturing\".\"dbt_dev_staging\".\"stg_production\"\n    group by vehicle_make, vehicle_model, vehicle_year\n)\n\nselect\n    md5(cast(coalesce(cast(make as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(model as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(year as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as vehicle_key,\n    make,\n    model,\n    year,\n    msrp,\n    first_seen_date as valid_from,\n    null::date as valid_to,\n    true as is_current,\n    current_timestamp as created_at\nfrom source_data", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev\".\"dim_vehicle_scd\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.942788Z", "completed_at": "2026-01-10T00:09:55.981471Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:55.984180Z", "completed_at": "2026-01-10T00:09:56.060753Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13170075416564941, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_int_quality_aggregated_quality_status__PASS__FAIL__UNKNOWN.5b160485b7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        quality_status as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_quality_aggregated\"\n    group by quality_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'PASS','FAIL','UNKNOWN'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:55.963016Z", "completed_at": "2026-01-10T00:09:55.983412Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.004587Z", "completed_at": "2026-01-10T00:09:56.064354Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13283824920654297, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_int_quality_aggregated_row_id.799ea261e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect row_id\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_quality_aggregated\"\nwhere row_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.008010Z", "completed_at": "2026-01-10T00:09:56.023482Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.026105Z", "completed_at": "2026-01-10T00:09:56.078910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10780119895935059, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_int_quality_aggregated_row_id.8b46476743", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    row_id as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_quality_aggregated\"\nwhere row_id is not null\ngroup by row_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.038066Z", "completed_at": "2026-01-10T00:09:56.049901Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.050876Z", "completed_at": "2026-01-10T00:09:56.100080Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07965612411499023, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_int_production_enriched_oee_category__EXCELLENT__GOOD__ACCEPTABLE__NEEDS_ATTENTION.1e1dd8edcf", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        oee_category as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n    group by oee_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'EXCELLENT','GOOD','ACCEPTABLE','NEEDS_ATTENTION'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.084882Z", "completed_at": "2026-01-10T00:09:56.097269Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.101493Z", "completed_at": "2026-01-10T00:09:56.152256Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07863020896911621, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.assert_defects_logical", "compiled": true, "compiled_code": "-- tests/business_rules/assert_defects_logical.sql\n-- Business rule: Defects cannot be greater than units produced\n-- This would be logically impossible\n\nselect\n    production_line,\n    date,\n    shift,\n    units_produced,\n    defects,\n    'Defects exceed production count' as failure_reason\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere defects > units_produced", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.091458Z", "completed_at": "2026-01-10T00:09:56.100893Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.107284Z", "completed_at": "2026-01-10T00:09:56.156526Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08142733573913574, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.assert_downtime_reasonable", "compiled": true, "compiled_code": "-- tests/business_rules/assert_downtime_reasonable.sql\n-- Business rule: Downtime cannot exceed 8 hours (one shift)\n-- Values above 8 hours indicate data errors\n\nselect\n    production_line,\n    date,\n    shift,\n    downtime_hours,\n    'Downtime exceeds shift duration' as failure_reason\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere downtime_hours > 8.0", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.118251Z", "completed_at": "2026-01-10T00:09:56.126916Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.128827Z", "completed_at": "2026-01-10T00:09:56.181318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09247636795043945, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.assert_no_future_dates", "compiled": true, "compiled_code": "-- tests/business_rules/assert_no_future_dates.sql\n-- Business rule: Production dates cannot be in the future\n-- Future dates indicate data entry errors\n\nselect\n    production_line,\n    date,\n    shift,\n    'Future production date detected' as failure_reason\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere date > current_date", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.133307Z", "completed_at": "2026-01-10T00:09:56.142322Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.144330Z", "completed_at": "2026-01-10T00:09:56.183892Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07715177536010742, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.assert_oee_valid_range", "compiled": true, "compiled_code": "-- tests/business_rules/assert_oee_valid_range.sql\n-- Business rule: OEE must be between 0 and 100 percent\n-- Any value outside this range indicates data quality issue\n\nselect\n    production_line,\n    date,\n    shift,\n    oee_percent,\n    'OEE out of valid range (0-100)' as failure_reason\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere oee_percent < 0 \n   or oee_percent > 100", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.174790Z", "completed_at": "2026-01-10T00:09:56.185335Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.192832Z", "completed_at": "2026-01-10T00:09:56.250173Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08649253845214844, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.assert_production_target_relationship", "compiled": true, "compiled_code": "-- tests/business_rules/assert_production_target_relationship.sql\n-- Business rule: Units produced shouldn't be >150% of target\n-- Extreme overproduction indicates possible data error\n\nselect\n    production_line,\n    date,\n    shift,\n    units_produced,\n    units_target,\n    (units_produced::float / nullif(units_target, 0) * 100) as achievement_percent,\n    'Production exceeds 150% of target - possible error' as failure_reason\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere units_produced > (units_target * 1.5)", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.186265Z", "completed_at": "2026-01-10T00:09:56.209882Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.213086Z", "completed_at": "2026-01-10T00:09:56.262730Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09461140632629395, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.dbt_utils_accepted_range_int_production_enriched_oee_percent__100__0.529e8069df", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not oee_percent >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not oee_percent <= 100\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.228750Z", "completed_at": "2026-01-10T00:09:56.238322Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.242662Z", "completed_at": "2026-01-10T00:09:56.294105Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08381938934326172, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_int_production_enriched_oee_percent.e34dfe2317", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect oee_percent\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere oee_percent is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.222694Z", "completed_at": "2026-01-10T00:09:56.237041Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.238981Z", "completed_at": "2026-01-10T00:09:56.292215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0932931900024414, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_int_production_enriched_date.6cc012b02d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.267221Z", "completed_at": "2026-01-10T00:09:56.275904Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.278682Z", "completed_at": "2026-01-10T00:09:56.335525Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08436918258666992, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_int_production_enriched_production_line.2c843f4fbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect production_line\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\nwhere production_line is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.327858Z", "completed_at": "2026-01-10T00:09:56.336981Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.343216Z", "completed_at": "2026-01-10T00:09:56.386927Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07021260261535645, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_int_maintenance_features_unit_device_id.70bfb020ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unit_device_id\nfrom \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_maintenance_features\"\nwhere unit_device_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.337606Z", "completed_at": "2026-01-10T00:09:56.352246Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.355084Z", "completed_at": "2026-01-10T00:09:56.399573Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08038496971130371, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_dim_vehicle_scd_is_current.152c8c7e42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_current\nfrom \"stellantis_manufacturing\".\"dbt_dev\".\"dim_vehicle_scd\"\nwhere is_current is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.296376Z", "completed_at": "2026-01-10T00:09:56.316995Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.319863Z", "completed_at": "2026-01-10T00:09:56.396289Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11936664581298828, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_int_maintenance_features_wear_status__LOW__MODERATE__HIGH__CRITICAL.26b3457590", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        wear_status as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_maintenance_features\"\n    group by wear_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'LOW','MODERATE','HIGH','CRITICAL'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.366602Z", "completed_at": "2026-01-10T00:09:56.376743Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.377690Z", "completed_at": "2026-01-10T00:09:56.427167Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07869696617126465, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_dim_vehicle_scd_valid_from.94752a4304", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom \"stellantis_manufacturing\".\"dbt_dev\".\"dim_vehicle_scd\"\nwhere valid_from is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.409636Z", "completed_at": "2026-01-10T00:09:56.419385Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.422929Z", "completed_at": "2026-01-10T00:09:56.474460Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07933878898620605, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_dim_vehicle_scd_vehicle_key.a3ddc7d29e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect vehicle_key\nfrom \"stellantis_manufacturing\".\"dbt_dev\".\"dim_vehicle_scd\"\nwhere vehicle_key is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.432429Z", "completed_at": "2026-01-10T00:09:56.445824Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.452553Z", "completed_at": "2026-01-10T00:09:56.496300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08270907402038574, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_dim_vehicle_scd_vehicle_key.53bcc07721", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    vehicle_key as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev\".\"dim_vehicle_scd\"\nwhere vehicle_key is not null\ngroup by vehicle_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.438061Z", "completed_at": "2026-01-10T00:09:56.444285Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.446729Z", "completed_at": "2026-01-10T00:09:56.551013Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13077569007873535, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.stellantis_dbt.int_oee_breakdown", "compiled": true, "compiled_code": "-- models/intermediate/int_oee_breakdown.sql\n-- Detailed OEE component analysis\n-- OEE = Availability \u00d7 Performance \u00d7 Quality\n\nwith production as (\n    select * from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n),\n\noee_calc as (\n    select\n        production_line,\n        date,\n        shift,\n        oee_percent,\n        units_produced,\n        units_target,\n        defects,\n        downtime_hours,\n        cycle_time_seconds,\n        estimated_revenue,\n        \n        -- Availability (uptime)\n        ((480 - (downtime_hours * 60)) / 480.0 * 100) as availability_percent,\n        \n        -- Performance (speed)\n        (units_produced::float / nullif(units_target, 0) * 100) as performance_percent,\n        \n        -- Quality (first pass yield)\n        ((units_produced - defects)::float / nullif(units_produced, 0) * 100) as quality_percent,\n        \n        dbt_loaded_at\n        \n    from production\n),\n\noee_components as (\n    select\n        *,\n        \n        -- Calculated OEE (for validation)\n        (availability_percent / 100.0 * performance_percent / 100.0 * quality_percent / 100.0 * 100) as calculated_oee_percent,\n        \n        -- Loss categories\n        downtime_hours * 60 as planned_downtime_min,\n        \n        case \n            when units_produced < units_target \n            then (units_target - units_produced) * cycle_time_seconds / 60.0\n            else 0 \n        end as speed_loss_min,\n        \n        defects * cycle_time_seconds / 60.0 as quality_loss_min,\n        \n        -- Bottleneck identification\n        case \n            when availability_percent < 90 then 'AVAILABILITY'\n            when performance_percent < 90 then 'PERFORMANCE'\n            when quality_percent < 95 then 'QUALITY'\n            else 'NONE'\n        end as primary_bottleneck,\n        \n        -- Improvement potential\n        (100 - oee_percent) * estimated_revenue / 100.0 as potential_revenue_gain\n        \n    from oee_calc\n)\n\nselect * from oee_components", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_oee_breakdown\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.463770Z", "completed_at": "2026-01-10T00:09:56.475194Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.476117Z", "completed_at": "2026-01-10T00:09:56.638923Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.18465542793273926, "adapter_response": {"_message": "SELECT 64", "code": "SELECT", "rows_affected": 64}, "message": "SELECT 64", "failures": null, "unique_id": "model.stellantis_dbt.mart_cost_analysis", "compiled": true, "compiled_code": "-- models/marts/mart_cost_analysis.sql\n-- Cost analysis and financial impact breakdown\n-- Answers: \"Where are we losing money? What's the ROI of improvements?\"\n\nwith production_costs as (\n    select\n        date,\n        production_line,\n        shift,\n        \n        -- Revenue\n        estimated_revenue,\n        \n        -- Cost components\n        defect_cost,\n        downtime_cost,\n        total_loss,\n        \n        -- Volume metrics for context\n        units_produced,\n        units_target,\n        defects,\n        downtime_hours,\n        \n        -- Performance context\n        oee_percent,\n        oee_category\n        \n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n),\n\naggregated_costs as (\n    select\n        date,\n        \n        -- Total costs by category\n        sum(defect_cost) as total_defect_cost,\n        sum(downtime_cost) as total_downtime_cost,\n        sum(total_loss) as total_loss,\n        sum(estimated_revenue) as total_revenue,\n        \n        -- Volume context\n        sum(units_produced) as total_units,\n        sum(defects) as total_defects,\n        sum(downtime_hours) as total_downtime_hours,\n        \n        -- Count by category\n        count(*) filter (where oee_category = 'NEEDS_ATTENTION') as poor_performance_shifts,\n        count(*) as total_shifts,\n        \n        -- By line breakdown\n        count(distinct production_line) as active_lines\n        \n    from production_costs\n    group by date\n),\n\nwith_calculations as (\n    select\n        date,\n        \n        -- Revenue & costs\n        total_revenue,\n        total_defect_cost,\n        total_downtime_cost,\n        total_loss,\n        total_revenue - total_loss as net_revenue,\n        \n        -- Loss breakdown percentages\n        (total_defect_cost::float / nullif(total_loss, 0) * 100) as defect_cost_percentage,\n        (total_downtime_cost::float / nullif(total_loss, 0) * 100) as downtime_cost_percentage,\n        \n        -- Loss as % of revenue\n        (total_loss::float / nullif(total_revenue, 0) * 100) as loss_percentage_of_revenue,\n        \n        -- Per unit costs\n        (total_defect_cost::float / nullif(total_units, 0)) as defect_cost_per_unit,\n        (total_downtime_cost::float / nullif(total_units, 0)) as downtime_cost_per_unit,\n        (total_loss::float / nullif(total_units, 0)) as total_loss_per_unit,\n        \n        -- Volume metrics\n        total_units,\n        total_defects,\n        total_downtime_hours,\n        active_lines,\n        total_shifts,\n        poor_performance_shifts,\n        \n        -- Performance context\n        (poor_performance_shifts::float / nullif(total_shifts, 0) * 100) as poor_performance_percentage,\n        \n        -- Potential savings (if all shifts were GOOD or better)\n        total_loss * (poor_performance_shifts::float / nullif(total_shifts, 0)) as potential_savings_from_improvement\n        \n    from aggregated_costs\n),\n\nwith_trends as (\n    select\n        *,\n        \n        -- Cost trends\n        lag(total_loss) over (order by date) as prev_day_loss,\n        total_loss - lag(total_loss) over (order by date) as loss_change_vs_yesterday,\n        \n        -- Rolling averages (7-day)\n        avg(total_loss) over (\n            order by date\n            rows between 6 preceding and current row\n        ) as rolling_7day_avg_loss,\n        \n        avg(total_defect_cost) over (\n            order by date\n            rows between 6 preceding and current row\n        ) as rolling_7day_avg_defect_cost,\n        \n        avg(total_downtime_cost) over (\n            order by date\n            rows between 6 preceding and current row\n        ) as rolling_7day_avg_downtime_cost,\n        \n        -- Month-to-date cumulative\n        sum(total_loss) over (\n            partition by date_trunc('month', date)\n            order by date\n        ) as mtd_cumulative_loss,\n        \n        sum(total_revenue) over (\n            partition by date_trunc('month', date)\n            order by date\n        ) as mtd_cumulative_revenue,\n        \n        -- Year-to-date cumulative\n        sum(total_loss) over (\n            partition by date_trunc('year', date)\n            order by date\n        ) as ytd_cumulative_loss\n        \n    from with_calculations\n),\n\nwith_priorities as (\n    select\n        *,\n        \n        -- MTD metrics\n        (mtd_cumulative_loss::float / nullif(mtd_cumulative_revenue, 0) * 100) as mtd_loss_percentage,\n        \n        -- Primary cost driver\n        case \n            when total_defect_cost > total_downtime_cost then 'DEFECTS'\n            when total_downtime_cost > total_defect_cost then 'DOWNTIME'\n            else 'BALANCED'\n        end as primary_cost_driver,\n        \n        -- Cost level severity\n        case \n            when loss_percentage_of_revenue > 10 then 'CRITICAL'\n            when loss_percentage_of_revenue > 5 then 'HIGH'\n            when loss_percentage_of_revenue > 3 then 'MEDIUM'\n            else 'LOW'\n        end as cost_severity,\n        \n        -- ROI opportunity (estimated annual if we reduce loss by 50%)\n        (total_loss * 0.5 * 365) as annual_roi_opportunity_50pct_reduction\n        \n    from with_trends\n)\n\nselect\n    -- Date\n    date,\n    \n    -- Revenue & Net\n    total_revenue,\n    total_loss,\n    net_revenue,\n    loss_percentage_of_revenue,\n    \n    -- Cost breakdown\n    total_defect_cost,\n    total_downtime_cost,\n    defect_cost_percentage,\n    downtime_cost_percentage,\n    primary_cost_driver,\n    \n    -- Per unit economics\n    defect_cost_per_unit,\n    downtime_cost_per_unit,\n    total_loss_per_unit,\n    \n    -- Volume context\n    total_units,\n    total_defects,\n    total_downtime_hours,\n    active_lines,\n    total_shifts,\n    poor_performance_shifts,\n    poor_performance_percentage,\n    \n    -- Improvement potential\n    potential_savings_from_improvement,\n    annual_roi_opportunity_50pct_reduction,\n    \n    -- Trends\n    loss_change_vs_yesterday,\n    rolling_7day_avg_loss,\n    rolling_7day_avg_defect_cost,\n    rolling_7day_avg_downtime_cost,\n    \n    -- Cumulative\n    mtd_cumulative_loss,\n    mtd_cumulative_revenue,\n    mtd_loss_percentage,\n    ytd_cumulative_loss,\n    \n    -- Severity & Priority\n    cost_severity,\n    \n    -- Action recommendation\n    case \n        when cost_severity = 'CRITICAL' and primary_cost_driver = 'DOWNTIME'\n            then 'URGENT: Focus on reducing downtime - maintenance review needed'\n        when cost_severity = 'CRITICAL' and primary_cost_driver = 'DEFECTS'\n            then 'URGENT: Quality improvement program required'\n        when cost_severity = 'HIGH' and primary_cost_driver = 'DOWNTIME'\n            then 'HIGH: Schedule maintenance optimization workshop'\n        when cost_severity = 'HIGH' and primary_cost_driver = 'DEFECTS'\n            then 'HIGH: Implement quality control improvements'\n        when poor_performance_percentage > 30\n            then 'MEDIUM: Training program for underperforming shifts'\n        else 'LOW: Continue monitoring and preventive measures'\n    end as recommended_action,\n    \n    -- Metadata\n    current_timestamp as mart_refreshed_at\n\nfrom with_priorities\norder by date desc", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_cost_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.497851Z", "completed_at": "2026-01-10T00:09:56.508400Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.511567Z", "completed_at": "2026-01-10T00:09:56.648915Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1604151725769043, "adapter_response": {"_message": "SELECT 64", "code": "SELECT", "rows_affected": 64}, "message": "SELECT 64", "failures": null, "unique_id": "model.stellantis_dbt.mart_executive_kpis", "compiled": true, "compiled_code": "-- models/marts/mart_executive_kpis.sql\n-- Daily executive dashboard - ONE row per day\n-- Answers: \"How did the factory perform TODAY?\"\n\nwith daily_production as (\n    -- Aggregate ALL production lines for each day\n    select\n        date,\n        \n        -- Volume metrics\n        count(distinct production_line) as active_lines,\n        count(*) as total_shifts_run,  -- Total shift records\n        sum(units_produced) as total_units_produced,\n        sum(units_target) as total_units_target,\n        \n        -- Performance metrics\n        avg(oee_percent) as avg_oee,\n        min(oee_percent) as worst_oee,\n        max(oee_percent) as best_oee,\n        \n        -- Quality metrics\n        sum(defects) as total_defects,\n        avg(defect_rate_percent) as avg_defect_rate,\n        \n        -- Time metrics\n        sum(downtime_hours) as total_downtime_hours,\n        avg(cycle_time_seconds) as avg_cycle_time,\n        \n        -- Cost metrics (from int_production_enriched)\n        sum(defect_cost) as total_defect_cost,\n        sum(downtime_cost) as total_downtime_cost,\n        sum(total_loss) as total_loss,\n        sum(estimated_revenue) as total_revenue\n        \n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n    group by date\n),\n\ndaily_with_calcs as (\n    select\n        date,\n        active_lines,\n        total_shifts_run,\n        total_units_produced,\n        total_units_target,\n        \n        -- Performance\n        avg_oee,\n        worst_oee,\n        best_oee,\n        \n        -- Target achievement\n        (total_units_produced::float / nullif(total_units_target, 0) * 100) as target_achievement_percent,\n        (total_units_target - total_units_produced) as units_below_target,\n        \n        -- Quality\n        total_defects,\n        avg_defect_rate,\n        (total_defects::float / nullif(total_units_produced, 0) * 100) as overall_defect_rate,\n        \n        -- Efficiency\n        total_downtime_hours,\n        total_downtime_hours / nullif(active_lines, 0) as avg_downtime_per_line,\n        avg_cycle_time,\n        \n        -- Costs & Revenue\n        total_defect_cost,\n        total_downtime_cost,\n        total_loss,\n        total_revenue,\n        total_revenue - total_loss as net_revenue,\n        (total_loss / nullif(total_revenue, 0) * 100) as loss_percentage,\n        \n        -- Performance classification\n        case \n            when avg_oee >= 85 then 'EXCELLENT'\n            when avg_oee >= 75 then 'GOOD'\n            when avg_oee >= 65 then 'ACCEPTABLE'\n            else 'CRITICAL'\n        end as factory_health_status\n        \n    from daily_production\n),\n\nwith_trends as (\n    select\n        *,\n        \n        -- Trend vs previous day (using window functions)\n        lag(total_units_produced) over (order by date) as prev_day_units,\n        lag(avg_oee) over (order by date) as prev_day_oee,\n        \n        -- Calculate change\n        total_units_produced - lag(total_units_produced) over (order by date) as units_change_vs_yesterday,\n        avg_oee - lag(avg_oee) over (order by date) as oee_change_vs_yesterday,\n        \n        -- 7-day rolling averages (for trend smoothing)\n        avg(avg_oee) over (\n            order by date \n            rows between 6 preceding and current row\n        ) as rolling_7day_avg_oee,\n        \n        avg(total_units_produced) over (\n            order by date \n            rows between 6 preceding and current row\n        ) as rolling_7day_avg_production\n        \n    from daily_with_calcs\n)\n\nselect\n    -- Date\n    date,\n    \n    -- Volume\n    active_lines,\n    total_shifts_run,\n    total_units_produced,\n    total_units_target,\n    target_achievement_percent,\n    units_below_target,\n    \n    -- Performance\n    avg_oee,\n    worst_oee,\n    best_oee,\n    factory_health_status,\n    \n    -- Quality\n    total_defects,\n    overall_defect_rate,\n    avg_defect_rate,\n    \n    -- Efficiency\n    total_downtime_hours,\n    avg_downtime_per_line,\n    avg_cycle_time,\n    \n    -- Financial\n    total_revenue,\n    total_defect_cost,\n    total_downtime_cost,\n    total_loss,\n    net_revenue,\n    loss_percentage,\n    \n    -- Trends\n    units_change_vs_yesterday,\n    oee_change_vs_yesterday,\n    rolling_7day_avg_oee,\n    rolling_7day_avg_production,\n    \n    -- Metadata\n    current_timestamp as mart_refreshed_at\n\nfrom with_trends\norder by date desc", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_executive_kpis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.528241Z", "completed_at": "2026-01-10T00:09:56.540306Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.542338Z", "completed_at": "2026-01-10T00:09:56.708650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.18889307975769043, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.stellantis_dbt.mart_line_performance", "compiled": true, "compiled_code": "-- models/marts/mart_line_performance.sql\n-- Production line rankings and performance comparison\n-- Answers: \"Which lines perform best/worst?\"\n\nwith line_aggregated as (\n    select\n        production_line,\n        \n        -- Time period\n        min(date) as first_production_date,\n        max(date) as last_production_date,\n        count(distinct date) as days_active,\n        count(*) as total_shifts,\n        \n        -- Volume metrics\n        sum(units_produced) as total_units_produced,\n        sum(units_target) as total_units_target,\n        avg(units_produced) as avg_units_per_shift,\n        \n        -- Performance metrics\n        avg(oee_percent) as avg_oee,\n        min(oee_percent) as worst_oee,\n        max(oee_percent) as best_oee,\n        stddev(oee_percent) as oee_std_dev,  -- Consistency metric\n        \n        -- Quality metrics\n        sum(defects) as total_defects,\n        avg(defect_rate_percent) as avg_defect_rate,\n        \n        -- Efficiency\n        sum(downtime_hours) as total_downtime_hours,\n        avg(cycle_time_seconds) as avg_cycle_time,\n        \n        -- Financial\n        sum(estimated_revenue) as total_revenue,\n        sum(total_loss) as total_loss,\n        \n        -- Categories (most frequent)\n        mode() within group (order by oee_category) as typical_oee_category,\n        mode() within group (order by quality_category) as typical_quality_category\n        \n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n    group by production_line\n),\n\nwith_rankings as (\n    select\n        *,\n        \n        -- Target achievement\n        (total_units_produced::float / nullif(total_units_target, 0) * 100) as target_achievement_percent,\n        \n        -- Downtime per day\n        total_downtime_hours / nullif(days_active, 0) as avg_downtime_hours_per_day,\n        \n        -- Rankings (1 = best)\n        rank() over (order by avg_oee desc) as oee_rank,\n        rank() over (order by total_units_produced desc) as production_volume_rank,\n        rank() over (order by avg_defect_rate asc) as quality_rank,\n        rank() over (order by total_downtime_hours asc) as uptime_rank,\n        \n        -- Percentile scores (0-100, higher = better)\n        percent_rank() over (order by avg_oee) * 100 as oee_percentile,\n        percent_rank() over (order by total_units_produced) * 100 as volume_percentile,\n        \n        -- Consistency score (lower std dev = more consistent)\n        case \n            when oee_std_dev = 0 then 100\n            else 100 - (oee_std_dev / (select max(oee_std_dev) from line_aggregated) * 100)\n        end as consistency_score\n        \n    from line_aggregated\n),\n\nwith_improvement as (\n    select\n        *,\n        \n        -- Improvement potential (vs best line)\n        max(avg_oee) over () - avg_oee as oee_gap_to_best,\n        \n        -- Revenue opportunity if this line matched best OEE\n        ((max(avg_oee) over () - avg_oee) / 100.0 * total_revenue) as potential_revenue_gain,\n        \n        -- Overall score (weighted: OEE 50%, Quality 30%, Volume 20%)\n        (oee_percentile * 0.5 + \n         (100 - percent_rank() over (order by avg_defect_rate) * 100) * 0.3 +\n         volume_percentile * 0.2) as overall_performance_score\n        \n    from with_rankings\n)\n\nselect\n    -- Line identification\n    production_line,\n    \n    -- Time metrics\n    first_production_date,\n    last_production_date,\n    days_active,\n    total_shifts,\n    \n    -- Volume\n    total_units_produced,\n    total_units_target,\n    target_achievement_percent,\n    avg_units_per_shift,\n    \n    -- Performance\n    avg_oee,\n    worst_oee,\n    best_oee,\n    oee_std_dev,\n    typical_oee_category,\n    \n    -- Quality\n    total_defects,\n    avg_defect_rate,\n    typical_quality_category,\n    \n    -- Efficiency\n    total_downtime_hours,\n    avg_downtime_hours_per_day,\n    avg_cycle_time,\n    \n    -- Financial\n    total_revenue,\n    total_loss,\n    \n    -- Rankings & Scores\n    oee_rank,\n    production_volume_rank,\n    quality_rank,\n    uptime_rank,\n    consistency_score,\n    overall_performance_score,\n    \n    -- Improvement potential\n    oee_gap_to_best,\n    potential_revenue_gain,\n    \n    -- Action priority\n    case \n        when overall_performance_score < 30 then 'CRITICAL - Immediate Action'\n        when overall_performance_score < 50 then 'HIGH - Schedule Review'\n        when overall_performance_score < 70 then 'MEDIUM - Monitor Closely'\n        else 'LOW - Maintain Performance'\n    end as priority_level,\n    \n    -- Metadata\n    current_timestamp as mart_refreshed_at\n\nfrom with_improvement\norder by overall_performance_score desc", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_line_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.585294Z", "completed_at": "2026-01-10T00:09:56.597597Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.599247Z", "completed_at": "2026-01-10T00:09:56.758899Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1836559772491455, "adapter_response": {"_message": "SELECT 960", "code": "SELECT", "rows_affected": 960}, "message": "SELECT 960", "failures": null, "unique_id": "model.stellantis_dbt.mart_quality_trends", "compiled": true, "compiled_code": "-- models/marts/mart_quality_trends.sql\n-- Quality trends analysis with anomaly detection\n-- Answers: \"Is quality improving? What are the patterns?\"\n\nwith daily_quality as (\n    select\n        date,\n        production_line,\n        shift,\n        \n        -- Aggregated metrics\n        sum(defects) as daily_defects,\n        sum(units_produced) as daily_units,\n        avg(defect_rate_percent) as avg_defect_rate,\n        \n        -- By category (from int_production_enriched)\n        count(*) filter (where quality_category = 'EXCELLENT') as excellent_count,\n        count(*) filter (where quality_category = 'GOOD') as good_count,\n        count(*) filter (where quality_category = 'ACCEPTABLE') as acceptable_count,\n        count(*) filter (where quality_category = 'POOR') as poor_count\n        \n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n    group by date, production_line, shift\n),\n\nwith_calculations as (\n    select\n        date,\n        production_line,\n        shift,\n        daily_defects,\n        daily_units,\n        \n        -- Defect rate\n        (daily_defects::float / nullif(daily_units, 0) * 100) as defect_rate_percent,\n        \n        -- Quality score (0-100, higher = better)\n        100 - (daily_defects::float / nullif(daily_units, 0) * 100) as quality_score,\n        \n        -- Category counts\n        excellent_count,\n        good_count,\n        acceptable_count,\n        poor_count,\n        excellent_count + good_count + acceptable_count + poor_count as total_shifts,\n        \n        -- Rolling averages (7-day window)\n        avg(daily_defects::float / nullif(daily_units, 0) * 100) over (\n            partition by production_line\n            order by date\n            rows between 6 preceding and current row\n        ) as rolling_7day_defect_rate,\n        \n        avg(daily_defects) over (\n            partition by production_line\n            order by date\n            rows between 6 preceding and current row\n        ) as rolling_7day_avg_defects,\n        \n        -- Month-to-date cumulative\n        sum(daily_defects) over (\n            partition by production_line, date_trunc('month', date)\n            order by date\n        ) as mtd_cumulative_defects,\n        \n        sum(daily_units) over (\n            partition by production_line, date_trunc('month', date)\n            order by date\n        ) as mtd_cumulative_units\n        \n    from daily_quality\n),\n\nwith_trends as (\n    select\n        *,\n        \n        -- Trend indicators\n        defect_rate_percent - lag(defect_rate_percent) over (\n            partition by production_line \n            order by date\n        ) as defect_rate_change_vs_yesterday,\n        \n        defect_rate_percent - rolling_7day_defect_rate as deviation_from_7day_avg,\n        \n        -- MTD defect rate\n        (mtd_cumulative_defects::float / nullif(mtd_cumulative_units, 0) * 100) as mtd_defect_rate,\n        \n        -- Anomaly detection (simple threshold-based)\n        case \n            when abs(defect_rate_percent - rolling_7day_defect_rate) > 2.0 \n            then true \n            else false \n        end as is_anomaly,\n        \n        -- Trend direction\n        case \n            when defect_rate_percent > lag(defect_rate_percent, 3) over (\n                partition by production_line order by date\n            ) then 'WORSENING'\n            when defect_rate_percent < lag(defect_rate_percent, 3) over (\n                partition by production_line order by date\n            ) then 'IMPROVING'\n            else 'STABLE'\n        end as trend_direction,\n        \n        -- Quality consistency (lower std dev = more consistent)\n        stddev(defect_rate_percent) over (\n            partition by production_line\n            order by date\n            rows between 6 preceding and current row\n        ) as quality_variability_7day\n        \n    from with_calculations\n)\n\nselect\n    -- Identifiers\n    date,\n    production_line,\n    shift,\n    \n    -- Volume\n    daily_units,\n    daily_defects,\n    \n    -- Quality metrics\n    defect_rate_percent,\n    quality_score,\n    \n    -- Rolling metrics\n    rolling_7day_defect_rate,\n    rolling_7day_avg_defects,\n    quality_variability_7day,\n    \n    -- MTD metrics\n    mtd_cumulative_defects,\n    mtd_cumulative_units,\n    mtd_defect_rate,\n    \n    -- Trends\n    defect_rate_change_vs_yesterday,\n    deviation_from_7day_avg,\n    trend_direction,\n    \n    -- Anomaly flag\n    is_anomaly,\n    \n    -- Category distribution\n    excellent_count,\n    good_count,\n    acceptable_count,\n    poor_count,\n    total_shifts,\n    (excellent_count::float / nullif(total_shifts, 0) * 100) as excellent_percentage,\n    \n    -- Alert level\n    case \n        when defect_rate_percent > 5.0 and trend_direction = 'WORSENING' \n            then 'CRITICAL - Immediate Action'\n        when defect_rate_percent > 3.0 and trend_direction = 'WORSENING'\n            then 'HIGH - Review Required'\n        when is_anomaly = true\n            then 'MEDIUM - Investigate Anomaly'\n        else 'LOW - Normal Operations'\n    end as alert_level,\n    \n    -- Metadata\n    current_timestamp as mart_refreshed_at\n\nfrom with_trends\norder by date desc, production_line, shift", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_quality_trends\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.734440Z", "completed_at": "2026-01-10T00:09:56.751989Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.754326Z", "completed_at": "2026-01-10T00:09:56.809343Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08487725257873535, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_int_oee_breakdown_primary_bottleneck__AVAILABILITY__PERFORMANCE__QUALITY__NONE.125f3d56cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        primary_bottleneck as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_oee_breakdown\"\n    group by primary_bottleneck\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'AVAILABILITY','PERFORMANCE','QUALITY','NONE'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.662897Z", "completed_at": "2026-01-10T00:09:56.673034Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.675801Z", "completed_at": "2026-01-10T00:09:56.814252Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15827345848083496, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.stellantis_dbt.mart_shift_analysis", "compiled": true, "compiled_code": "-- models/marts/mart_shift_analysis.sql\n-- Shift performance comparison and optimization\n-- Answers: \"Which shifts perform best? How can we optimize staffing?\"\n\nwith shift_aggregated as (\n    select\n        shift,\n        \n        -- Volume\n        count(*) as total_records,\n        count(distinct production_line) as lines_operated,\n        count(distinct date) as days_active,\n        sum(units_produced) as total_units_produced,\n        sum(units_target) as total_units_target,\n        avg(units_produced) as avg_units_per_shift,\n        \n        -- Performance\n        avg(oee_percent) as avg_oee,\n        min(oee_percent) as worst_oee,\n        max(oee_percent) as best_oee,\n        stddev(oee_percent) as oee_variability,\n        \n        -- Quality\n        sum(defects) as total_defects,\n        avg(defect_rate_percent) as avg_defect_rate,\n        \n        -- Efficiency\n        sum(downtime_hours) as total_downtime_hours,\n        avg(downtime_hours) as avg_downtime_per_record,\n        avg(cycle_time_seconds) as avg_cycle_time,\n        \n        -- Financial\n        sum(estimated_revenue) as total_revenue,\n        sum(total_loss) as total_loss,\n        sum(defect_cost) as total_defect_cost,\n        sum(downtime_cost) as total_downtime_cost,\n        \n        -- Categories\n        count(*) filter (where oee_category = 'EXCELLENT') as excellent_shifts,\n        count(*) filter (where oee_category = 'GOOD') as good_shifts,\n        count(*) filter (where oee_category = 'NEEDS_ATTENTION') as poor_shifts\n        \n    from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_production_enriched\"\n    group by shift\n),\n\nwith_calcs as (\n    select\n        *,\n        \n        -- Achievement rates\n        (total_units_produced::float / nullif(total_units_target, 0) * 100) as target_achievement_percent,\n        (total_defects::float / nullif(total_units_produced, 0) * 100) as overall_defect_rate,\n        \n        -- Per-day metrics\n        total_units_produced / nullif(days_active, 0) as avg_units_per_day,\n        total_downtime_hours / nullif(days_active, 0) as avg_downtime_per_day,\n        \n        -- Revenue metrics\n        total_revenue - total_loss as net_revenue,\n        (total_loss / nullif(total_revenue, 0) * 100) as loss_percentage,\n        \n        -- Productivity per hour (assuming 8-hour shifts)\n        total_units_produced / nullif(total_records * 8.0, 0) as units_per_hour,\n        \n        -- Quality rate\n        (excellent_shifts + good_shifts)::float / nullif(total_records, 0) * 100 as quality_shift_percentage\n        \n    from shift_aggregated\n),\n\nwith_comparisons as (\n    select\n        *,\n        \n        -- Rankings\n        rank() over (order by avg_oee desc) as oee_rank,\n        rank() over (order by total_units_produced desc) as production_rank,\n        rank() over (order by avg_defect_rate asc) as quality_rank,\n        \n        -- Comparison to best shift\n        max(avg_oee) over () as best_shift_oee,\n        avg_oee - max(avg_oee) over () as oee_gap_to_best,\n        \n        -- Improvement potential\n        ((max(avg_oee) over () - avg_oee) / 100.0 * total_revenue) as potential_revenue_if_match_best,\n        \n        -- Performance score\n        ((avg_oee / max(avg_oee) over ()) * 50 +\n         (1 - avg_defect_rate / nullif(max(avg_defect_rate) over (), 0)) * 30 +\n         (units_per_hour / max(units_per_hour) over ()) * 20) as performance_score\n        \n    from with_calcs\n)\n\nselect\n    -- Shift identification\n    shift,\n    \n    -- Volume metrics\n    total_records as shift_count,\n    lines_operated,\n    days_active,\n    total_units_produced,\n    total_units_target,\n    target_achievement_percent,\n    avg_units_per_shift,\n    avg_units_per_day,\n    units_per_hour,\n    \n    -- Performance metrics\n    avg_oee,\n    worst_oee,\n    best_oee,\n    oee_variability,\n    \n    -- Quality metrics\n    total_defects,\n    avg_defect_rate,\n    overall_defect_rate,\n    \n    -- Efficiency metrics\n    total_downtime_hours,\n    avg_downtime_per_record,\n    avg_downtime_per_day,\n    avg_cycle_time,\n    \n    -- Financial metrics\n    total_revenue,\n    total_loss,\n    total_defect_cost,\n    total_downtime_cost,\n    net_revenue,\n    loss_percentage,\n    \n    -- Shift quality distribution\n    excellent_shifts,\n    good_shifts,\n    poor_shifts,\n    quality_shift_percentage,\n    \n    -- Rankings & comparisons\n    oee_rank,\n    production_rank,\n    quality_rank,\n    performance_score,\n    \n    -- Improvement potential\n    oee_gap_to_best,\n    potential_revenue_if_match_best,\n    \n    -- Recommendations\n    case \n        when performance_score >= 90 then 'BENCHMARK - Use as training example'\n        when performance_score >= 70 then 'GOOD - Minor optimizations possible'\n        when performance_score >= 50 then 'REVIEW - Significant improvement needed'\n        else 'CRITICAL - Immediate intervention required'\n    end as recommendation,\n    \n    -- Metadata\n    current_timestamp as mart_refreshed_at\n\nfrom with_comparisons\norder by performance_score desc", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_shift_analysis\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.781950Z", "completed_at": "2026-01-10T00:09:56.793677Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.794722Z", "completed_at": "2026-01-10T00:09:56.851193Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08196544647216797, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_cost_analysis_cost_severity__CRITICAL__HIGH__MEDIUM__LOW.dc7afd1708", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        cost_severity as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_cost_analysis\"\n    group by cost_severity\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'CRITICAL','HIGH','MEDIUM','LOW'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.840750Z", "completed_at": "2026-01-10T00:09:56.852349Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.853692Z", "completed_at": "2026-01-10T00:09:56.899272Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07697248458862305, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_cost_analysis_date.89aa03460e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_cost_analysis\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.830821Z", "completed_at": "2026-01-10T00:09:56.858322Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.860698Z", "completed_at": "2026-01-10T00:09:56.904575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08430337905883789, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_cost_analysis_primary_cost_driver__DEFECTS__DOWNTIME__BALANCED.fcb29d1242", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        primary_cost_driver as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_cost_analysis\"\n    group by primary_cost_driver\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'DEFECTS','DOWNTIME','BALANCED'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.874445Z", "completed_at": "2026-01-10T00:09:56.889248Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.891399Z", "completed_at": "2026-01-10T00:09:56.951142Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.081390380859375, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_mart_cost_analysis_date.0b49e97cdd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_cost_analysis\"\nwhere date is not null\ngroup by date\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.918886Z", "completed_at": "2026-01-10T00:09:56.928225Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.936393Z", "completed_at": "2026-01-10T00:09:56.971330Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.062041521072387695, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_executive_kpis_factory_health_status__EXCELLENT__GOOD__ACCEPTABLE__CRITICAL.3a2b2ad0a0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        factory_health_status as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_executive_kpis\"\n    group by factory_health_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'EXCELLENT','GOOD','ACCEPTABLE','CRITICAL'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.929613Z", "completed_at": "2026-01-10T00:09:56.940435Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.941124Z", "completed_at": "2026-01-10T00:09:56.987255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06833648681640625, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_executive_kpis_avg_oee.763ef73c40", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_oee\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_executive_kpis\"\nwhere avg_oee is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.962392Z", "completed_at": "2026-01-10T00:09:56.975716Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.977986Z", "completed_at": "2026-01-10T00:09:57.030712Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07684659957885742, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_executive_kpis_date.239f1ecbb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_executive_kpis\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.010333Z", "completed_at": "2026-01-10T00:09:57.022272Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.023503Z", "completed_at": "2026-01-10T00:09:57.075485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0850670337677002, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_mart_executive_kpis_date.8e10285e0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_executive_kpis\"\nwhere date is not null\ngroup by date\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.997866Z", "completed_at": "2026-01-10T00:09:57.016456Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.018248Z", "completed_at": "2026-01-10T00:09:57.087318Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1023406982421875, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_executive_kpis_total_units_produced.9279e48764", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_units_produced\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_executive_kpis\"\nwhere total_units_produced is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.043742Z", "completed_at": "2026-01-10T00:09:57.057387Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.064575Z", "completed_at": "2026-01-10T00:09:57.251420Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2202918529510498, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_line_performance_priority_level__CRITICAL_Immediate_Action__HIGH_Schedule_Review__MEDIUM_Monitor_Closely__LOW_Maintain_Performance.3c636d4fa1", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        priority_level as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_line_performance\"\n    group by priority_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'CRITICAL - Immediate Action','HIGH - Schedule Review','MEDIUM - Monitor Closely','LOW - Maintain Performance'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:56.685159Z", "completed_at": "2026-01-10T00:09:56.695725Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:56.701696Z", "completed_at": "2026-01-10T00:09:57.268375Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5993602275848389, "adapter_response": {"_message": "SELECT 10000", "code": "SELECT", "rows_affected": 10000}, "message": "SELECT 10000", "failures": null, "unique_id": "model.stellantis_dbt.mart_maintenance_overview", "compiled": true, "compiled_code": "-- models/marts/mart_maintenance_overview.sql\n-- Machine health overview and failure prediction\n-- Answers: \"Which machines need attention? When will they fail?\"\n\nwith maintenance_features as (\n    select * from \"stellantis_manufacturing\".\"dbt_dev_intermediate\".\"int_maintenance_features\"\n),\n\nmachine_aggregated as (\n    select\n        product_id,\n        product_type,\n        \n        -- Aggregated metrics\n        count(*) as total_observations,\n        max(failure_risk_score) as max_risk_score,\n        avg(failure_risk_score) as avg_risk_score,\n        \n        -- Latest readings (most recent)\n        max(air_temperature_c) as latest_air_temp,\n        max(process_temperature_c) as latest_process_temp,\n        max(rotational_speed_rpm) as latest_speed,\n        max(torque_nm) as latest_torque,\n        max(tool_wear_min) as latest_tool_wear,\n        max(power_kw) as latest_power,\n        \n        -- Average conditions\n        avg(air_temperature_c) as avg_air_temp,\n        avg(process_temperature_c) as avg_process_temp,\n        avg(rotational_speed_rpm) as avg_speed,\n        avg(torque_nm) as avg_torque,\n        avg(tool_wear_min) as avg_tool_wear,\n        \n        -- Failure history\n        sum(machine_failure) as total_failures,\n        sum(tool_wear_failure) as tool_wear_failures,\n        sum(heat_dissipation_failure) as heat_failures,\n        sum(power_failure) as power_failures,\n        sum(overstrain_failure) as overstrain_failures,\n        sum(random_failure) as random_failures,\n        \n        -- Latest status (most recent record)\n        mode() within group (order by wear_status) as current_wear_status,\n        mode() within group (order by speed_category) as typical_speed_category,\n        mode() within group (order by failure_type) as most_common_failure_type\n        \n    from maintenance_features\n    group by product_id, product_type\n),\n\nwith_risk_assessment as (\n    select\n        *,\n        \n        -- Failure rate\n        (total_failures::float / nullif(total_observations, 0) * 100) as failure_rate_percent,\n        \n        -- Risk category based on multiple factors\n        case \n            when max_risk_score >= 80 or latest_tool_wear >= 200 then 'CRITICAL'\n            when max_risk_score >= 60 or latest_tool_wear >= 150 then 'HIGH'\n            when max_risk_score >= 40 or latest_tool_wear >= 100 then 'MEDIUM'\n            else 'LOW'\n        end as risk_category,\n        \n        -- Maintenance urgency (days until recommended maintenance)\n        case \n            when latest_tool_wear >= 200 then 0  -- Immediate\n            when latest_tool_wear >= 180 then 7  -- Within a week\n            when latest_tool_wear >= 150 then 14 -- Within 2 weeks\n            when latest_tool_wear >= 120 then 30 -- Within a month\n            else 60 -- Within 2 months\n        end as days_until_maintenance,\n        \n        -- Dominant failure mode\n        case \n            when tool_wear_failures > heat_failures \n                 and tool_wear_failures > power_failures \n                 and tool_wear_failures > overstrain_failures\n                 then 'TOOL_WEAR'\n            when heat_failures > power_failures \n                 and heat_failures > overstrain_failures\n                 then 'HEAT_DISSIPATION'\n            when power_failures > overstrain_failures\n                 then 'POWER'\n            when overstrain_failures > 0\n                 then 'OVERSTRAIN'\n            else 'RANDOM'\n        end as dominant_failure_mode,\n        \n        -- Operating stress level\n        case \n            when latest_power > 15 then 'HIGH_STRESS'\n            when latest_power > 10 then 'MEDIUM_STRESS'\n            else 'LOW_STRESS'\n        end as operating_stress,\n        \n        -- Ranking by risk\n        rank() over (order by max_risk_score desc) as risk_rank,\n        rank() over (order by latest_tool_wear desc) as wear_rank,\n        rank() over (order by total_failures desc) as failure_count_rank\n        \n    from machine_aggregated\n),\n\nwith_recommendations as (\n    select\n        *,\n        \n        -- Specific action recommendations\n        case \n            when risk_category = 'CRITICAL' then 'STOP PRODUCTION - Replace tool immediately'\n            when risk_category = 'HIGH' and dominant_failure_mode = 'TOOL_WEAR' \n                 then 'Schedule tool replacement within 7 days'\n            when risk_category = 'HIGH' and dominant_failure_mode = 'HEAT_DISSIPATION'\n                 then 'Inspect cooling system within 7 days'\n            when risk_category = 'HIGH' and dominant_failure_mode = 'POWER'\n                 then 'Check electrical system within 7 days'\n            when risk_category = 'MEDIUM' \n                 then 'Schedule preventive maintenance within 2 weeks'\n            else 'Continue monitoring - routine maintenance'\n        end as action_recommendation,\n        \n        -- Estimated cost if failure occurs (vs preventive maintenance)\n        case \n            when risk_category = 'CRITICAL' then 50000  -- Emergency repair\n            when risk_category = 'HIGH' then 25000\n            when risk_category = 'MEDIUM' then 10000\n            else 5000\n        end as estimated_failure_cost,\n        \n        -- Preventive maintenance cost\n        case \n            when dominant_failure_mode = 'TOOL_WEAR' then 2000\n            when dominant_failure_mode = 'HEAT_DISSIPATION' then 3000\n            when dominant_failure_mode = 'POWER' then 5000\n            else 1500\n        end as preventive_maintenance_cost,\n        \n        -- Cost savings (failure cost - preventive cost)\n        case \n            when risk_category = 'CRITICAL' then 50000 - 2000\n            when risk_category = 'HIGH' then 25000 - 2000\n            when risk_category = 'MEDIUM' then 10000 - 1500\n            else 0\n        end as potential_cost_savings\n        \n    from with_risk_assessment\n)\n\nselect\n    -- Machine identification\n    product_id,\n    product_type,\n    \n    -- Observation count\n    total_observations,\n    \n    -- Current status (latest readings)\n    latest_air_temp,\n    latest_process_temp,\n    latest_speed,\n    latest_torque,\n    latest_tool_wear,\n    latest_power,\n    current_wear_status,\n    operating_stress,\n    \n    -- Average conditions\n    avg_air_temp,\n    avg_process_temp,\n    avg_speed,\n    avg_torque,\n    avg_tool_wear,\n    \n    -- Risk assessment\n    max_risk_score,\n    avg_risk_score,\n    risk_category,\n    days_until_maintenance,\n    \n    -- Failure history\n    total_failures,\n    failure_rate_percent,\n    tool_wear_failures,\n    heat_failures,\n    power_failures,\n    overstrain_failures,\n    random_failures,\n    dominant_failure_mode,\n    most_common_failure_type,\n    \n    -- Rankings\n    risk_rank,\n    wear_rank,\n    failure_count_rank,\n    \n    -- Financial impact\n    estimated_failure_cost,\n    preventive_maintenance_cost,\n    potential_cost_savings,\n    \n    -- Recommendations\n    action_recommendation,\n    \n    -- Priority flag for dashboard\n    case \n        when risk_category = 'CRITICAL' then 1\n        when risk_category = 'HIGH' then 2\n        when risk_category = 'MEDIUM' then 3\n        else 4\n    end as priority_order,\n    \n    -- Metadata\n    current_timestamp as mart_refreshed_at\n\nfrom with_recommendations\norder by priority_order, max_risk_score desc", "relation_name": "\"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_maintenance_overview\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.110620Z", "completed_at": "2026-01-10T00:09:57.243540Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.252115Z", "completed_at": "2026-01-10T00:09:57.309271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21510624885559082, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_line_performance_avg_oee.413501162e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_oee\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_line_performance\"\nwhere avg_oee is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.244155Z", "completed_at": "2026-01-10T00:09:57.255980Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.257773Z", "completed_at": "2026-01-10T00:09:57.315356Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21363139152526855, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_line_performance_production_line.4c4692c439", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect production_line\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_line_performance\"\nwhere production_line is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.293364Z", "completed_at": "2026-01-10T00:09:57.305788Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.309971Z", "completed_at": "2026-01-10T00:09:57.356475Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08205866813659668, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_quality_trends_trend_direction__IMPROVING__STABLE__WORSENING.81b1edaa7b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        trend_direction as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_quality_trends\"\n    group by trend_direction\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'IMPROVING','STABLE','WORSENING'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.278717Z", "completed_at": "2026-01-10T00:09:57.286377Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.288774Z", "completed_at": "2026-01-10T00:09:57.354422Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09461116790771484, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_mart_line_performance_production_line.163b8ffef2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    production_line as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_line_performance\"\nwhere production_line is not null\ngroup by production_line\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.337648Z", "completed_at": "2026-01-10T00:09:57.357260Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.359082Z", "completed_at": "2026-01-10T00:09:57.411706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08707714080810547, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_quality_trends_date.8e23190fd0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_quality_trends\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.344371Z", "completed_at": "2026-01-10T00:09:57.358375Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.363390Z", "completed_at": "2026-01-10T00:09:57.414901Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08874130249023438, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_shift_analysis_recommendation__BENCHMARK_Use_as_training_example__GOOD_Minor_optimizations_possible__REVIEW_Significant_improvement_needed__CRITICAL_Immediate_intervention_required.0497b282a8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        recommendation as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_shift_analysis\"\n    group by recommendation\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BENCHMARK - Use as training example','GOOD - Minor optimizations possible','REVIEW - Significant improvement needed','CRITICAL - Immediate intervention required'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.389165Z", "completed_at": "2026-01-10T00:09:57.401013Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.405046Z", "completed_at": "2026-01-10T00:09:57.455160Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08579254150390625, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_shift_analysis_shift.8944f6ed40", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shift\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_shift_analysis\"\nwhere shift is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.382190Z", "completed_at": "2026-01-10T00:09:57.398906Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.401837Z", "completed_at": "2026-01-10T00:09:57.458049Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08909821510314941, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_shift_analysis_avg_oee.f81316d4fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_oee\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_shift_analysis\"\nwhere avg_oee is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.433595Z", "completed_at": "2026-01-10T00:09:57.446684Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.447689Z", "completed_at": "2026-01-10T00:09:57.508224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08769011497497559, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_mart_shift_analysis_shift.348002cccb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    shift as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_shift_analysis\"\nwhere shift is not null\ngroup by shift\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.441383Z", "completed_at": "2026-01-10T00:09:57.456036Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.459427Z", "completed_at": "2026-01-10T00:09:57.512195Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08475518226623535, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.accepted_values_mart_maintenance_overview_risk_category__CRITICAL__HIGH__MEDIUM__LOW.12804edacc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        risk_category as value_field,\n        count(*) as n_records\n\n    from \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_maintenance_overview\"\n    group by risk_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'CRITICAL','HIGH','MEDIUM','LOW'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.479275Z", "completed_at": "2026-01-10T00:09:57.495704Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.500712Z", "completed_at": "2026-01-10T00:09:57.530157Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05887413024902344, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.not_null_mart_maintenance_overview_product_id.8bdc4ecb65", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_maintenance_overview\"\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-10T00:09:57.485025Z", "completed_at": "2026-01-10T00:09:57.495036Z"}, {"name": "execute", "started_at": "2026-01-10T00:09:57.497609Z", "completed_at": "2026-01-10T00:09:57.533777Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.060973405838012695, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.stellantis_dbt.unique_mart_maintenance_overview_product_id.26265df926", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"stellantis_manufacturing\".\"dbt_dev_marts\".\"mart_maintenance_overview\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.4575674533843994, "args": {"populate_cache": true, "strict_mode": false, "which": "build", "source_freshness_run_project_hooks": false, "invocation_command": "dbt build", "log_format": "default", "show_resource_report": false, "send_anonymous_usage_stats": true, "project_dir": "/home/vanel/stellantis-manufacturing-analytics/dbt_project", "version_check": true, "macro_debugging": false, "profiles_dir": "/home/vanel/.dbt", "static_parser": true, "print": true, "indirect_selection": "eager", "use_colors": true, "select": [], "log_path": "/home/vanel/stellantis-manufacturing-analytics/dbt_project/logs", "empty": false, "exclude": [], "log_format_file": "debug", "cache_selected_only": false, "log_file_max_bytes": 10485760, "vars": {}, "introspect": true, "partial_parse": true, "enable_legacy_logger": false, "printer_width": 80, "quiet": false, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "resource_types": [], "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "export_saved_queries": false, "show": false, "include_saved_query": false, "exclude_resource_types": [], "use_colors_file": true, "require_resource_names_without_spaces": false, "log_level": "info", "write_json": true, "defer": false, "partial_parse_file_diff": true}}